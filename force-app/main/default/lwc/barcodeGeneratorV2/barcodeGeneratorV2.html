<template>
    <lightning-card title="Barcode Generator V2.0" icon-name="custom:custom14">
        
        <div class="slds-m-around_medium">
            
            <!-- Section 1: Order Information -->
            <div class="slds-box slds-m-bottom_medium">
                <div class="slds-text-heading_small slds-m-bottom_x-small">
                    Order Information
                </div>
                <div class="slds-grid slds-wrap">
                    <div class="slds-col slds-size_1-of-2">
                        <div class="slds-text-body_small slds-text-color_weak">Order Number</div>
                        <div class="slds-text-body_regular">{orderNumber}</div>
                    </div>
                    <div class="slds-col slds-size_1-of-2">
                        <div class="slds-text-body_small slds-text-color_weak">Account</div>
                        <div class="slds-text-body_regular">{accountName}</div>
                    </div>
                </div>
            </div>
            
            <!-- Section 2: Order Barcode -->
            <div class="slds-box slds-m-bottom_medium">
                <div class="slds-text-heading_small slds-m-bottom_small">
                    Order Barcode
                </div>
                
                <!-- Generate Button (shows before barcode generated) -->
                <template if:false={orderBarcodeGenerated}>
                    <div class="slds-text-align_center slds-m-vertical_medium">
                        <lightning-button 
                            label="Generate Order Barcode" 
                            onclick={handleGenerateOrderBarcode}
                            variant="brand"
                            icon-name="utility:apex">
                        </lightning-button>
                    </div>
                </template>
                
                <!-- Barcode Display (shows after generation) -->
                <template if:true={orderBarcodeGenerated}>
                    <div class="barcode-container">
                        <div class="barcode-title">ORDER BARCODE</div>
                        <div class="barcode-subtitle">Order Level Tracking</div>
                        
                        <!-- SVG barcode will be inserted here -->
                        <div class="barcode-display">
                            <svg lwc:dom="manual" class="barcode-svg"></svg>
                        </div>
                        
                        <div class="barcode-label">Order: {orderNumber}</div>
                        <div class="barcode-sublabel">Account: {accountName}</div>
                    </div>
                    
                    <div class="slds-text-align_center slds-m-top_small">
                        <lightning-badge label="Barcode Generated" class="slds-badge_success"></lightning-badge>
                    </div>
                </template>
            </div>
            
<!-- Section 3: Product Barcodes -->
<div class="slds-box slds-m-bottom_medium">
    <div class="slds-text-heading_small slds-m-bottom_small">
        Product Barcodes
        <span class="slds-text-body_small slds-text-color_weak"> (Master barcode per product type)</span>
    </div>
    
    <!-- Generate Button (shows before products loaded) -->
    <template if:false={productsLoaded}>
        <div class="slds-text-align_center slds-m-vertical_medium">
            <lightning-button 
                label="Generate Product Barcodes" 
                onclick={handleGenerateProductBarcodes}
                variant="brand"
                icon-name="utility:products">
            </lightning-button>
        </div>
    </template>
    
    <!-- Products Display (shows after generation) -->
    <template if:true={productsLoaded}>
        <template if:true={hasProducts}>
            <!-- Products Grid -->
            <div class="products-grid">
                <template for:each={products} for:item="product">
                    <div key={product.productId} class="product-card">
                        <div class="product-header">
                            <lightning-icon icon-name="standard:product" size="small"></lightning-icon>
                            <span class="product-name">{product.productName}</span>
                        </div>
                        
                        <!-- Product Barcode -->
                        <div class="barcode-container-small">
                            <div class="barcode-subtitle">Product Master Barcode</div>
                            <div class="barcode-display-small">
                                <svg lwc:dom="manual" class="barcode-svg-product" data-product-id={product.productId}></svg>
                            </div>
                            <div class="barcode-label-small">Product: {product.productName}</div>
                            <div class="barcode-sublabel">ID: {product.productId}</div>
                        </div>
                    </div>
                </template>
            </div>
            
            <div class="slds-text-align_center slds-m-top_small">
                <lightning-badge label=" Product Barcode Generated" class="slds-badge_success"></lightning-badge>
            </div>
        </template>
        
        <!-- No Products Message -->
        <template if:false={hasProducts}>
            <div class="slds-text-align_center slds-text-color_weak slds-m-vertical_medium">
                No products found in this order.
            </div>
        </template>
    </template>
</div>

<!-- Section 4: Coming Soon (Line Items) -->
<div class="slds-box slds-m-bottom_medium" style="background: #f3f3f3;">
    <div class="slds-text-heading_small slds-m-bottom_x-small">
        Coming in Next Piece
    </div>
    <ul class="slds-list_dotted">
        <li>Line Item Barcodes (Piece 5)</li>
        <li>Print Functionality</li>
    </ul>
</div>
            
            <!-- Close Button -->
            <div class="slds-text-align_center">
                <lightning-button 
                    label="Close" 
                    onclick={handleClose}
                    variant="neutral">
                </lightning-button>
            </div>
            
        </div>
        
    </lightning-card>
</template>